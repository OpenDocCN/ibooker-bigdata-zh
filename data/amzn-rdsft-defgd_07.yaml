- en: Chapter 6\. Amazon Redshift Machine Learning
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第六章 Amazon Redshift 机器学习
- en: Machine learning and artificial intelligence have come from being concepts of
    science fiction to everyday companions, be it on your mobile device or empowering
    businesses with the ability to disrupt and enhance existing processes in every
    segment of decision making.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习和人工智能已经从科幻概念发展为日常伴侣，无论是在您的移动设备上还是在赋予企业能力以颠覆和增强决策制定的各个领域。
- en: According to research by [GlobalNewsWire](https://oreil.ly/6keHq), the AI/ML
    market is projected to grow to a $1.4 trillion industry by 2029\. The [PwC 2022
    AI Business Survey](https://oreil.ly/jACdB) shows 86% of respondents said AI technology
    is a mainstream part of their company, and 52% of respondents are accelerating
    adoption for AI/ML.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 根据 [GlobalNewsWire](https://oreil.ly/6keHq) 的研究，AI/ML 市场预计将在 2029 年发展成为一个 1.4
    万亿美元的行业。 [PwC 2022 AI Business Survey](https://oreil.ly/jACdB) 显示，86% 的受访者表示 AI
    技术是公司的主流部分，52% 的受访者正在加速对 AI/ML 的采用。
- en: Here’s an example of how a company using Redshift’s AI/ML capabilities improved
    their business. Jobcase, a leading online job-search platform for job seekers,
    needs to perform job matching for more than 110 million registered members across
    the United States by identifying strong matches to suggest quality jobs for its
    members. It also helps employers hire qualified workers. Its recommendation system
    generates specific job listing recommendations, as well as search suggestions
    and company recommendations. Using AI/ML, Jobcase was able to achieve 5% improvement
    in member engagement metrics, which translates to an improved member experience,
    higher member retention, and a corresponding increase in revenue. They were also
    able to reduce testing time from 1 to 2 months to under a week, eliminated the
    need to move data to a separate ML environment, improved scalability, and were
    able to make billions of predictions in around 15 minutes instead of 4 to 5 hours.
    See the case study [“Jobcase Scales ML Workflows to Support Billions of Daily
    Predictions Using Amazon Redshift ML”](https://oreil.ly/v12dX) for additional
    details.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个公司利用 Redshift 的 AI/ML 能力改进业务的示例。Jobcase，一家领先的面向求职者的在线求职平台，需要为超过 1.1 亿注册会员进行职位匹配，通过识别强匹配项为其会员推荐优质工作。它还帮助雇主招聘合格的工人。其推荐系统生成特定的职位列表推荐，以及搜索建议和公司推荐。使用
    AI/ML，Jobcase 能够在会员参与度指标上实现 5% 的改进，这转化为提升的会员体验、更高的会员保留率和相应的收入增长。他们还能将测试时间从 1 到
    2 个月缩短到不到一周，消除了将数据移至单独的 ML 环境的需要，提高了可伸缩性，并能在约 15 分钟内进行数十亿次预测，而不是原来的 4 到 5 小时。详细信息请参阅案例研究
    [“Jobcase Scales ML Workflows to Support Billions of Daily Predictions Using Amazon
    Redshift ML”](https://oreil.ly/v12dX)。
- en: 'Here’s another example: Magellan Rx Management, a division of Magellan Health,
    Inc., develops and delivers predictive analytics to forecast future drugs costs,
    identify drugs that will drive future trends, and proactively identify patients
    at risk for becoming nonadherent to their medications, via their MRx Predict solution
    built on top of Amazon Redshift ML. Prior to Amazon Redshift ML, they had data
    analysts and clinicians manually categorize any new drugs into the appropriate
    therapeutic conditions. With Amazon Redshift ML, they now make the predictions
    using standard SQL programming to predict appropriate drug therapeutic conditions,
    which improves their operational efficiency while maintaining a high level of
    clinical accuracy. See the blog post [“How Magellan Rx Management Used Amazon
    Redshift ML to Predict Drug Therapeutic Conditions”](https://oreil.ly/x6mXd) for
    additional details.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是另一个例子：Magellan Rx Management，Magellan Health, Inc. 的一个部门，开发并提供预测分析，以预测未来的药品成本，识别将推动未来趋势的药品，并积极识别可能变得不依从其药物治疗的患者，通过他们在
    Amazon Redshift ML 上构建的 MRx Predict 解决方案。在使用 Amazon Redshift ML 之前，他们的数据分析师和临床医生需要手动将任何新药物分类到适当的治疗条件中。使用
    Amazon Redshift ML，他们现在使用标准 SQL 编程进行预测，以预测适当的药物治疗条件，从而提高了操作效率，同时保持高水平的临床准确性。详细信息请参阅博客文章
    [“How Magellan Rx Management Used Amazon Redshift ML to Predict Drug Therapeutic
    Conditions”](https://oreil.ly/x6mXd)。
- en: In this chapter, we will cover the end-to-end [“Machine Learning Cycle”](#machine_learning_cycle)
    and how [“Amazon Redshift ML”](#redshift_ml) enables multiple personas in your
    organization with the tools to start leveraging [“Machine Learning Techniques”](#machine_learning_techniques)
    to drive innovation. We will also dive deep in the different [“Machine Learning
    Algorithms”](#ml_algorithms) and show you through an example how you can use [“Integration
    with Amazon SageMaker Autopilot”](#amazon_sagemaker_autopilot_integration) to
    predict outcomes of a fictitious street race between humans and machines. We will
    also continue with our student information system dataset and explain [“Using
    Amazon Redshift ML to Predict Student Outcomes”](#redshift-ml-student-outcomes).
    We’ll also describe how certain ML problems can’t be solved with Amazon SageMaker
    Autopilot. In those cases you can use [“Amazon SageMaker Integration with Amazon
    Redshift”](#sagemaker_integration_redshift) to access Amazon Redshift data with
    the Amazon SageMaker canvas tool to build your model. With your model in place,
    you can leverage [“Integration with Amazon SageMaker—Bring Your Own Model (BYOM)”](#amazon_sagemaker_byom_integration)
    to run inferences in Amazon Redshift. Lastly, we’ll cover the [“Amazon Redshift
    ML Costs”](#redshift_ml_costs).
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将涵盖端到端的[“机器学习周期”](#machine_learning_cycle)，以及[“Amazon Redshift ML”](#redshift_ml)如何为您的组织中的多个角色提供工具，以开始利用[“机器学习技术”](#machine_learning_techniques)推动创新。我们还将深入探讨不同的[“机器学习算法”](#ml_algorithms)，并通过一个示例向您展示如何使用[“与Amazon
    SageMaker Autopilot集成”](#amazon_sagemaker_autopilot_integration)来预测人类与机器之间虚构街头竞赛的结果。我们还将继续使用我们的学生信息系统数据集，并解释[“使用Amazon
    Redshift ML预测学生结果”](#redshift-ml-student-outcomes)。我们还将描述某些ML问题无法通过Amazon SageMaker
    Autopilot解决的情况。在这些情况下，您可以使用[“Amazon SageMaker与Amazon Redshift集成”](#sagemaker_integration_redshift)通过Amazon
    SageMaker画布工具访问Amazon Redshift数据来构建您的模型。有了您的模型，您可以利用[“与Amazon SageMaker集成—自带模型
    (BYOM)”](#amazon_sagemaker_byom_integration)在Amazon Redshift中进行推断。最后，我们将介绍[“Amazon
    Redshift ML成本”](#redshift_ml_costs)。
- en: Machine Learning Cycle
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 机器学习周期
- en: 'The typical steps involved in machine learning ([Figure 6-1](#ml_life_cycle))
    include the following: data gathering, data preparation and cleansing, ML model
    and algorithm selection, setting up the training environment, training the ML
    model, evaluating and tuning the ML model, deploying the ML model for production
    usage with scaling, and finally, making predictions to drive business decisions.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习中涉及的典型步骤（[图6-1](#ml_life_cycle)）包括以下步骤：数据收集，数据准备和清洗，ML模型和算法选择，设置训练环境，训练ML模型，评估和调整ML模型，部署ML模型以供生产使用并进行扩展，最后进行预测以驱动业务决策。
- en: The quality of your ML model is directly influenced by the quality of the data
    you use. Incorrect or outdated data will result in wrong outcomes or predictions
    that are not relevant. Thus preparing your data for building ML models involves
    cleansing data to remove unwanted data, missing values, duplicate values, and
    even converting data types for certain attributes. You might even need to restructure
    the dataset and transpose the rows and columns or index of rows and columns. You
    also need to split the dataset into training dataset and testing dataset used
    to check the accuracy of your model after training. A good training dataset is
    relevant, contains minimal missing and repeated values, and provides a good representation
    of the various subcategories/classes present. With Amazon Redshift ML you can
    leverage your data warehouse data that is already cleansed and validated as source
    data for building ML models.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 您的ML模型的质量直接受您使用数据的质量影响。不正确或过时的数据将导致错误的结果或不相关的预测。因此，为构建ML模型准备数据涉及数据清理，以删除不需要的数据、缺失值、重复值，甚至转换某些属性的数据类型。您可能需要重新组织数据集并转置行和列或索引行和列。您还需要将数据集分割为用于训练和测试的数据集，以在训练后检查模型的准确性。一个好的训练数据集是相关的，包含最少的缺失和重复值，并提供各种子类/类别的良好表示。通过Amazon
    Redshift ML，您可以利用已经清洗和验证的数据仓库数据作为构建ML模型的源数据。
- en: '![Typical ML lifecycle](assets/ardg_0601.png)'
  id: totrans-9
  prefs: []
  type: TYPE_IMG
  zh: '![典型ML生命周期](assets/ardg_0601.png)'
- en: Figure 6-1\. Typical ML lifecycle
  id: totrans-10
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图6-1\. 典型ML生命周期
- en: Once you have your dataset for ML, you need to choose a model for training.
    The ML model determines the output you get after running an ML algorithm on the
    collected data. It is important to choose a model that is relevant to your task
    at hand. Scientists and engineers have developed various ML models, like linear
    regression, decision tree, nearest neighbor, and random forest, to name a few.
    These are suited for different tasks like speech recognition, image recognition,
    prediction, and numerous various use cases. Apart from model type, you also need
    to choose your model algorithm based on whether it is suited for numerical or
    categorical data and choose one accordingly.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦你有了用于机器学习的数据集，你需要选择一个用于训练的模型。机器学习模型决定了在收集的数据上运行机器学习算法后得到的输出结果。选择一个与你手头任务相关的模型至关重要。科学家和工程师们开发了各种机器学习模型，比如线性回归、决策树、最近邻、随机森林等等。这些模型适用于不同的任务，比如语音识别、图像识别、预测以及各种不同的用例。除了模型类型，你还需要根据数据是数值型还是分类型来选择适合的模型算法，然后据此进行选择。
- en: Once you have decided on the model type, you now need to set up the model training
    environment. You have to configure the infrastructure components that build up
    your ML training environment and decide on storage for your data, code, and models.
    Identify what compute is best suited for the type of ML model you are trying to
    build. Install necessary software, integrated development environments (IDE),
    frameworks, and algorithms to begin your ML journey.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦确定了模型类型，现在你需要设置模型训练环境。你必须配置构成你的机器学习训练环境的基础设施组件，并决定数据、代码和模型的存储方式。确定最适合你尝试构建的机器学习模型类型的计算资源。安装必要的软件、集成开发环境（IDE）、框架和算法，开始你的机器学习之旅。
- en: You train, debug, and tune your ML model iteratively in your training environment.
    When ready, you need to deploy to your production environment, validate the predictions,
    and monitor the performance of your ML model execution. This step often involves
    scaling your infrastructure to achieve the performance expectations and business
    SLAs for model execution.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在你的训练环境中，你会迭代地训练、调试和调优你的机器学习模型。当准备好时，你需要部署到生产环境，验证预测结果，并监控机器学习模型执行的性能。这一步通常涉及扩展你的基础设施，以实现模型执行的性能期望和业务服务级别协议（SLA）。
- en: We have covered the ML process at only a high level, but you can see that it
    is a very intensive and iterative process until you get the perfectly tuned model
    fitting your specific use case.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 我们只是以高层次介绍了机器学习过程，但你可以看到，直到你获得完全调优的适合你特定用例的模型之前，这是一个非常密集和迭代的过程。
- en: Amazon Redshift ML
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Amazon Redshift ML
- en: To solve business problems, organizations use ML techniques like supervised,
    unsupervised, and reinforcement learning, which we cover later in [“Machine Learning
    Techniques”](#machine_learning_techniques). But to implement these techniques
    requires an understanding of ever-evolving tools and technologies to gain ML-based
    insights. However, Amazon Redshift ML enables data analysts, data scientists,
    or decision makers to create, train, and deploy ML models using familiar SQL commands.
    To create an ML model, users need to write a `CREATE MODEL` command and pass the
    necessary data available in Amazon Redshift.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 为了解决业务问题，组织使用监督学习、无监督学习和强化学习等机器学习技术，我们稍后在[“机器学习技术”](#machine_learning_techniques)中会详细讨论。但要实施这些技术需要理解不断发展的工具和技术，以获得基于机器学习的洞见。然而，Amazon
    Redshift ML使数据分析师、数据科学家或决策者能够使用熟悉的SQL命令创建、训练和部署机器学习模型。要创建一个机器学习模型，用户需要编写`CREATE
    MODEL`命令，并传递Amazon Redshift中可用的必要数据。
- en: When Amazon Redshift ML executes a `CREATE MODEL` SQL command, it securely exports
    data from Amazon Redshift to Amazon S3, calls Amazon SageMaker Autopilot to prepare
    data and train the ML model, and finally Amazon SageMaker Neo to make the ML model
    available as an SQL function in Amazon Redshift (see [Figure 6-2](#redshift_ML_arch)).
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 当Amazon Redshift ML执行`CREATE MODEL` SQL命令时，它会安全地将数据从Amazon Redshift导出到Amazon
    S3，调用Amazon SageMaker Autopilot准备数据和训练机器学习模型，最后使用Amazon SageMaker Neo将机器学习模型作为SQL函数在Amazon
    Redshift中提供（参见[Figure 6-2](#redshift_ML_arch)）。
- en: In other words, Amazon Redshift ML communicates with various cloud-based services
    like Amazon S3, Amazon SageMaker, and Amazon Redshift under the hood to simplify
    model development with SQL queries.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 换句话说，Amazon Redshift ML在幕后与Amazon S3、Amazon SageMaker和Amazon Redshift等各种基于云的服务进行通信，以简化使用SQL查询进行模型开发。
- en: '![Amazon Redshift ML Architecture](assets/ardg_0602.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![Amazon Redshift ML Architecture](assets/ardg_0602.png)'
- en: Figure 6-2\. Amazon Redshift ML Architecture
  id: totrans-20
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: Figure 6-2\. Amazon Redshift ML 架构
- en: Amazon Redshift ML uses Amazon SageMaker to build and train ML models. [Amazon
    SageMaker](https://aws.amazon.com/sagemaker) is a fully managed service for preparing
    data and building, training, and deploying ML models and running predictions with
    fully managed infrastructure, tools, and workflows.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 使用 [Amazon SageMaker](https://aws.amazon.com/sagemaker) 构建和训练
    ML 模型。Amazon SageMaker 是一个全管理服务，用于准备数据、构建、训练和部署 ML 模型，并使用完全管理的基础设施、工具和工作流来运行预测。
- en: Amazon SageMaker Autopilot preprocesses the training data, such as substituting
    missing data with a different value, to retain most of the data/information of
    the dataset. It recognizes the characteristics of categorical columns like country/state/zip
    code, and properly formats them for training. It chooses the best preprocessors
    and identifies the most fitting algorithm and algorithm hyperparameters that will
    deliver the model with the most accurate predictions.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon SageMaker Autopilot 预处理训练数据，例如用不同值替换缺失数据，以保留数据集的大部分信息。它识别分类列的特征，如国家/州/邮政编码，并为训练适当地格式化它们。它选择最佳预处理器，并确定最合适的算法和算法超参数，以提供最准确的预测模型。
- en: When the model has been trained, Amazon Redshift ML uses [Amazon SageMaker Neo](https://aws.amazon.com/sagemaker/neo),
    which optimizes the ML model for deployment and makes it available as an SQL function
    within Amazon Redshift. You can use the SQL function to apply the ML model to
    your data in queries, reports, and dashboards. All this is happening automatically
    by executing the `CREATE MODEL` command, covered in [“Create Model”](#create_model).
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 模型训练完成后，Amazon Redshift ML 使用 [Amazon SageMaker Neo](https://aws.amazon.com/sagemaker/neo)，优化
    ML 模型以进行部署，并将其作为 SQL 函数在 Amazon Redshift 中提供。您可以使用 SQL 函数在查询、报告和仪表板中应用 ML 模型。通过执行
    `CREATE MODEL` 命令来实现所有这些功能，详见 [“Create Model”](#create_model)。
- en: Amazon Redshift ML Flexibility
  id: totrans-24
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 灵活性
- en: Amazon Redshift ML provides the `CREATE MODEL` command with the default option
    of `AUTO ON`. When you use `AUTO ON` with Amazon Redshift ML and run the SQL command
    to create the model, Amazon Redshift ML exports the specified data from Amazon
    Redshift to Amazon S3 and calls SageMaker Autopilot to automatically prepare the
    data, select the appropriate prebuilt algorithm, and apply the algorithm for model
    training. Amazon Redshift ML handles all the interactions between Amazon Redshift,
    Amazon S3, and SageMaker, abstracting the steps involved in training and compilation.
    After the model is trained, Amazon Redshift ML makes it available as a SQL function
    in your Amazon Redshift data warehouse.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 提供 `CREATE MODEL` 命令，并默认选项为 `AUTO ON`。当您使用 `AUTO ON` 与 Amazon
    Redshift ML 并运行 SQL 命令创建模型时，Amazon Redshift ML 将指定的数据从 Amazon Redshift 导出到 Amazon
    S3，并调用 SageMaker Autopilot 自动准备数据，选择适当的预构建算法，并应用算法进行模型训练。Amazon Redshift ML 处理
    Amazon Redshift、Amazon S3 和 SageMaker 之间的所有交互，抽象出训练和编译的步骤。模型训练完成后，Amazon Redshift
    ML 将其作为 SQL 函数提供在您的 Amazon Redshift 数据仓库中使用。
- en: The `AUTO OFF` option is for advanced users who know the model type and hyperparameters
    to use for training. This will turn off the create model automatic discovery of
    preprocessors and hyperparameters and can reduce the time taken to create models
    compared to the `AUTO ON` option. With the `AUTO OFF` option, you can have finer
    control on training of Amazon Redshift models.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '`AUTO OFF` 选项适用于了解模型类型和训练超参数的高级用户。这会关闭创建模型的自动发现预处理器和超参数的功能，并且相较于 `AUTO ON`
    选项，可以减少创建模型所需的时间。使用 `AUTO OFF` 选项，您可以更精细地控制 Amazon Redshift 模型的训练。'
- en: '![Amazon Redshift ML flexibility](assets/ardg_0603.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![Amazon Redshift ML 灵活性](assets/ardg_0603.png)'
- en: Figure 6-3\. Amazon Redshift ML flexibility
  id: totrans-28
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 图 6-3\. Amazon Redshift ML 灵活性
- en: In [Figure 6-3](#ml_flexibility), you can see that Amazon Redshift ML provides
    channels for varying levels of ML knowledge. Any data analyst who is familiar
    with SQL language can use the auto option to get started with Amazon Redshift
    ML. There is no requirement to know the details of the ML algorithms or ML programming
    languages like [Python](https://www.python.org/about) or [R](https://www.r-project.org/about.html).
    Amazon Redshift ML is also useful for data scientists who have a good handle on
    the ML algorithms and want to tune the model for specific properties. Amazon Redshift
    ML also supports a Bring Your Own Model (BYOM) approach, which we cover in [“Integration
    with Amazon SageMaker—Bring Your Own Model (BYOM)”](#amazon_sagemaker_byom_integration),
    where you leverage a SageMaker environment to choose the particular runtimes and
    compute types to build, train, and tune the model. You can then import the model
    and run inferences in Amazon Redshift or draw remote inferences directly from
    SageMaker using your data from Amazon Redshift.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 在[图 6-3](#ml_flexibility)中，您可以看到Amazon Redshift ML为不同水平的ML知识提供了渠道。任何熟悉SQL语言的数据分析师都可以使用自动选项开始使用Amazon
    Redshift ML，无需了解ML算法的详细信息或ML编程语言如[Python](https://www.python.org/about)或[R](https://www.r-project.org/about.html)。对于熟悉ML算法并希望调整模型特性的数据科学家来说，Amazon
    Redshift ML也非常有用。Amazon Redshift ML还支持一种自带模型（BYOM）的方法，我们在[“与Amazon SageMaker集成——自带模型（BYOM）”](#amazon_sagemaker_byom_integration)中进行了介绍，通过这种方法，您可以利用SageMaker环境选择特定的运行时和计算类型来构建、训练和调整模型。然后，您可以在Amazon
    Redshift中导入模型并运行推理，或者直接从SageMaker中使用您的数据进行远程推理。
- en: Getting Started with Amazon Redshift ML
  id: totrans-30
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开始使用Amazon Redshift ML
- en: Amazon Redshift needs explicit permissions granted to interact with Amazon SageMaker
    for its machine learning capabilities. Set this up by configuring your [IAM role](https://oreil.ly/M6Wvn)
    for Amazon Redshift ML.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift需要明确授权才能与其机器学习功能的Amazon SageMaker进行交互。通过为Amazon Redshift ML配置您的[IAM角色](https://oreil.ly/M6Wvn)来设置此功能。
- en: As a best practice, you should segregate permissions for creating a model versus
    permissions for using the model for prediction functions. The queries in [Example 6-1](#ml_grants)
    showcase two groups, `model_create_grp` with permissions to create models, and
    `model_user_grp` with permissions to use your ML model for inference.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 作为最佳实践，您应该将创建模型的权限与使用模型进行预测功能的权限分开。示例 6-1中的查询展示了两个组，`model_create_grp`具有创建模型的权限，而`model_user_grp`具有用于推理您的ML模型的权限。
- en: Example 6-1\. Grants for Amazon Redshift ML
  id: totrans-33
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-1\. 为Amazon Redshift ML授予权限
- en: '[PRE0]'
  id: totrans-34
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Amazon Redshift supports different languages along with default `sql` language.
    You can query table `SVV_LANGUAGE_PRIVILEGES` to see all the languages and the
    privileges granted to the user, role, or group. Amazon Redshift ML is also another
    language in Amazon Redshift and will show up as `mlfunc` in this table.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift支持默认的`sql`语言以及其他不同的语言。您可以查询`SVV_LANGUAGE_PRIVILEGES`表格以查看用户、角色或组授予的所有语言和权限。Amazon
    Redshift ML也是Amazon Redshift中的另一种语言，在该表中显示为`mlfunc`。
- en: Amazon Redshift grants privileges to the ML language when you execute the grant
    statement to allow creating models (see [Example 6-2](#lang_privileges)).
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 当您执行授权语句以允许创建模型时，Amazon Redshift会向ML语言授予权限（参见[示例 6-2](#lang_privileges)）。
- en: Example 6-2\. Language privileges
  id: totrans-37
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-2\. 语言权限
- en: '[PRE1]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '| language_name | privilege | identity_type | identity_name | identity_id |
    admin_option |'
  id: totrans-39
  prefs: []
  type: TYPE_TB
  zh: '| language_name | privilege | identity_type | identity_name | identity_id |
    admin_option |'
- en: '| --- | --- | --- | --- | --- | --- |'
  id: totrans-40
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- | --- | --- |'
- en: '| c | USAGE | public | public | 0 | false |'
  id: totrans-41
  prefs: []
  type: TYPE_TB
  zh: '| c | USAGE | public | public | 0 | false |'
- en: '| internal | USAGE | public | public | 0 | false |'
  id: totrans-42
  prefs: []
  type: TYPE_TB
  zh: '| internal | USAGE | public | public | 0 | false |'
- en: '| mlfunc | USAGE | group | model_create_grp | 834679 | false |'
  id: totrans-43
  prefs: []
  type: TYPE_TB
  zh: '| mlfunc | USAGE | group | model_create_grp | 834679 | false |'
- en: '| plpgsql | USAGE | public | public | 0 | false |'
  id: totrans-44
  prefs: []
  type: TYPE_TB
  zh: '| plpgsql | USAGE | public | public | 0 | false |'
- en: '| sql | USAGE | public | public | 0 | false |'
  id: totrans-45
  prefs: []
  type: TYPE_TB
  zh: '| sql | USAGE | public | public | 0 | false |'
- en: '| plpythonu | USAGE | public | public | 0 | false |'
  id: totrans-46
  prefs: []
  type: TYPE_TB
  zh: '| plpythonu | USAGE | public | public | 0 | false |'
- en: Machine Learning Techniques
  id: totrans-47
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 机器学习技术
- en: 'Machine learning models find patterns in your data and then apply these patterns
    to generate predictions on new data. There are many varieties of ML techniques,
    but here are three general approaches:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 机器学习模型在您的数据中发现模式，然后将这些模式应用于生成新数据的预测。有许多种类的ML技术，但以下是三种常见的方法：
- en: Supervised machine learning
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 监督机器学习
- en: The algorithm analyzes labeled data and learns how to map input data to an output
    label. It is often used for classification and prediction.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 该算法分析标记数据并学习如何将输入数据映射到输出标签。通常用于分类和预测。
- en: Unsupervised machine learning
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 无监督机器学习
- en: Unlike supervised, this algorithm is not used for predicting an outcome, so
    it is considered unlabeled. This algorithm finds patterns by clustering data and
    identifying similarities in clustered data. Popular uses include recommendation
    systems and targeted advertising.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 不同于监督学习，这种算法不用于预测结果，因此被视为未标记。这种算法通过对数据进行聚类并识别聚类数据中的相似性来找出模式。常见用途包括推荐系统和定向广告。
- en: Reinforcement learning
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 强化学习
- en: This technique is where the ML model learns in a fashion similar to how a human
    learns, through trial and error. Reinforcement learning is geared toward a digital
    agent who is put in a specific environment to learn problem solving. Similar to
    how we learn new things, the agent faces a game-like situation and must make a
    series of decisions to try to achieve the correct outcome. Through trial and error,
    the agent will learn what to do and what not to do, and is rewarded or punished
    accordingly. Every time it receives a reward, it reinforces the behavior and signals
    the agent to use the same tactic again next time. Through such training, machine
    learning models can be taught to follow instructions, conduct tests, and operate
    equipment, for example.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这种技术类似于人类学习的方式，通过试错来学习。强化学习针对一个被置于特定环境中的数字代理，以学习问题解决。类似于我们学习新事物的方式，代理面临着类似游戏的情境，并必须做出一系列决策来尝试达到正确的结果。通过试错，代理将学会该如何做和不该做，并相应地受到奖励或惩罚。每次获得奖励时，都会强化这种行为，并向代理信号使用同样的策略。通过这样的训练，机器学习模型可以被教导遵循指令，进行测试和操作设备，例如。
- en: Amazon Redshift ML supports the supervised and unsupervised learning approaches.
    Due to the complex nature of reinforcement learning, while it is supported in
    Amazon SageMaker, it is not a technique supported by Amazon Redshift ML.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 由于强化学习的复杂性，尽管在亚马逊 SageMaker 中受到支持，但在亚马逊 Redshift ML 中并不支持这种技术。
- en: Supervised Learning Techniques
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 监督学习技术
- en: Supervised learning is the most common ML approach, where you begin with a training
    dataset that has input data columns and output data columns. These input data
    attributes to your ML model are referred to as “features,” and the output data
    attributes are referred as “labels.” This training dataset is designed to train
    the ML algorithm into classifying data or predicting output label accurately.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 监督学习是最常见的机器学习方法，你从具有输入数据列和输出数据列的训练数据集开始。这些输入数据属性到你的机器学习模型被称为“特征”，输出数据属性被称为“标签”。这个训练数据集旨在训练机器学习算法以准确分类数据或预测输出标签。
- en: 'There are two types of supervised-learning ML problems that Amazon Redshift
    ML supports: classification and regression. Your particular use case will fall
    in only one of these distinct problem types:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 有两种亚马逊 Redshift ML 支持的监督学习 ML 问题：分类和回归。你的特定用例将只属于这两个不同的问题类型之一：
- en: 'Classification problems are for assigning data into specific categories. There
    are two types of classifications:'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 分类问题用于将数据分配到特定类别中。分类有两种类型：
- en: Binary classification refers to the problem of predicting one of *two* outcomes,
    such as classifying spam in your inbox or predicting whether a customer churns
    or not.
  id: totrans-60
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 二分类是指预测*两种*结果的问题，例如在你的收件箱中分类垃圾邮件或预测客户是否会流失。
- en: Multiclass classification refers to the problem of predicting one of *many*
    outcomes, such as predicting which particular credit card from your broad array
    for credit cards a particular customer might be most interested in pursuing.
  id: totrans-61
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多类分类是指预测*多种*结果的问题，例如预测特定客户可能最感兴趣的信用卡类型。
- en: A regression problem is the task of approximating a mapping function from input
    variables to a continuous output variable. It uses an algorithm to understand
    the relationship between dependent and independent variables (features), and defines
    the mapping function to predict the output variable (label). A continuous output
    variable is a real-value, an integer or floating point value, often quantities
    like amounts and sizes, such as sales revenue projections for a given business
    or the total spending of customers.
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 回归问题是从输入变量到连续输出变量的映射函数的近似任务。它使用算法来理解依赖变量和独立变量（特征）之间的关系，并定义映射函数来预测输出变量（标签）。连续输出变量是实值，整数或浮点值，通常是数量，例如给定业务的销售收入预测或客户的总支出。
- en: A specific regression problem where input variables are ordered by time is called
    a time series forecasting problem. This problem is solved by a forecast model.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 一个特定的回归问题，其中输入变量按时间顺序排列，被称为时间序列预测问题。这个问题由预测模型解决。
- en: '[Amazon Forecast](https://aws.amazon.com/forecast) is a fully managed service
    that uses statistical and machine learning algorithms to deliver time-series forecasts.
    Amazon Redshift ML supports building forecasting models using Amazon Forecast.
    This lets you use historical data over a time period to make predictions about
    future events. Common use cases of Amazon Forecast include using retail product
    data to decide how to price inventory, historical orders to predict market demand,
    historical manufacturing and sales data to predict how much of one item to order,
    and web traffic data to forecast how much traffic a web server might receive.'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '[Amazon Forecast](https://aws.amazon.com/forecast) 是一种完全托管的服务，使用统计和机器学习算法来提供时间序列预测。Amazon
    Redshift ML 支持使用 Amazon Forecast 构建预测模型。这使您可以使用一段时间内的历史数据来预测未来事件。Amazon Forecast
    的常见用例包括使用零售产品数据决定如何定价库存，使用历史订单预测市场需求，使用历史制造和销售数据预测需要订购的某一商品数量，以及使用网站流量数据预测Web服务器可能收到的流量量。'
- en: Quota limits from Amazon Forecast are enforced in Amazon Redshift forecast models;
    for example, the maximum number of forecasts is 100, although this can be changed
    via a support request.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Forecast 的配额限制在 Amazon Redshift 预测模型中执行；例如，最多可以进行 100 次预测，尽管这可以通过支持请求进行更改。
- en: Dropping a forecast model doesn’t automatically delete the associated resources
    in Amazon Forecast.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 删除预测模型不会自动删除 Amazon Forecast 中关联的资源。
- en: Unsupervised Learning Techniques
  id: totrans-67
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 无监督学习技术
- en: Unsupervised learning uses ML algorithms to analyze datasets to discover hidden
    patterns in data without the need for human intervention, and hence falls under
    the unsupervised learning category. Unlike supervised learning, where you have
    defined input attributes and defined output attributes, unsupervised learning
    is about identifying anomalies or outliers in your data.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 无监督学习使用 ML 算法分析数据集，发现数据中的隐藏模式，无需人类干预，因此属于无监督学习类别。与监督学习不同，监督学习具有定义的输入属性和输出属性，无监督学习则是识别数据中的异常或离群值。
- en: 'There are three types of unsupervised ML problem types that Amazon Redshift
    ML supports via Amazon SageMaker: clustering, association, and dimensionality
    reduction. Your particular use case can fall in more than one of these problem
    types at the same time.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 通过 Amazon SageMaker 支持三种类型的无监督 ML 问题类型：聚类、关联和降维。您的特定用例可能同时属于这些问题类型中的多种。
- en: '*Clustering* is a technique for grouping unlabeled data based on their similarities
    or differences and then identifying the outliers; for example, *k*-means clustering
    algorithms assign similar data points into groups, where the *k* value represents
    the size of the grouping and granularity. It attempts to find discrete groupings
    within data, whereby members of a group are as similar as possible to one another
    and as different as possible from members of other groups. This clustering technique
    is helpful for segmentation, where you want to minimize the variance within each
    cluster or segment; for example, a credit card company can segment its loyalty
    card customers into different groups based on their buying behavior and launch
    targeted campaigns or promotional products.'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*聚类*是一种根据它们的相似性或差异对未标记数据进行分组的技术，然后识别异常值；例如，*k*-means聚类算法将相似的数据点分配到组中，其中*k*值表示组的大小和粒度。它试图在数据中找到离散的分组，其中组的成员彼此尽可能相似，并且与其他组的成员尽可能不同。这种聚类技术对于分割很有帮助，例如，信用卡公司可以根据客户的购买行为将其忠诚卡客户分成不同的组，并启动有针对性的活动或促销产品。'
- en: '*Association* uses different rules to find relationships between variables
    in a given dataset, along the lines of recommendations such as “customers who
    bought this item also bought” type of problems.'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '*关联*使用不同的规则在给定数据集中查找变量之间的关系，例如推荐系统中的“购买了此商品的客户还购买了”类似问题。'
- en: '*Dimensionality reduction* is used when the number of features (or dimensions
    or input columns) in a given dataset is too high. It reduces the number of data
    inputs to a manageable size while also preserving the data integrity, such as
    when encoders remove noise from visual data to improve picture quality.'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '*降维*在给定数据集中特征（或维度或输入列）的数量过高时使用。它减少数据输入的数量到一个可管理的大小，同时保持数据的完整性，例如编码器从视觉数据中去除噪音以改善图片质量。'
- en: Machine Learning Algorithms
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 机器学习算法
- en: We’ve covered problem types, and now we’ll discuss algorithms that can be used
    to solve these problem types. For a deeper understanding of the specific problem
    types and the particular algorithm that can be used to solve that particular problem
    type, see [the documentation on Amazon SageMaker’s built-in algorithms](https://oreil.ly/LaxlD).
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经涵盖了问题类型，现在我们将讨论可以用来解决这些问题类型的算法。要深入了解特定的问题类型及可用于解决该特定问题类型的特定算法，请参阅[Amazon
    SageMaker内置算法的文档](https://oreil.ly/LaxlD)。
- en: For supervised learning, Amazon Redshift ML supports Extreme Gradient Boosting
    (XGBoost), multilayer perceptron (MLP), and linear learner algorithms.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 对于监督学习，Amazon Redshift ML支持极限梯度增强（XGBoost）、多层感知器（MLP）和线性学习器算法。
- en: The XGBoost algorithm is an optimized open source implementation of the gradient
    boosted trees algorithm. XGBoost is designed from the ground up to handle many
    data science problems in a efficient, flexible, portable, and accurate way. XGBoost
    can be used for regression, binary classification, multiclass classification,
    and ranking problems. Ranking problem types are for finding artifacts in relevance
    order. They associate a numeric score for each input in the query to the final
    artifact. Once you have the relevance score of each artifact, you can rank the
    artifacts according to those scores and predict the top N best match values. For
    details on XGBoost and SageMaker, see the blog post [“Introducing the Open-Source
    Amazon SageMaker XGBoost Algorithm Container”](https://oreil.ly/NmfuI).
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: XGBoost算法是梯度增强树算法的优化开源实现。XGBoost从头开始设计，以高效、灵活、便携和准确的方式处理许多数据科学问题。XGBoost可用于回归、二分类、多分类和排名问题。排名问题类型用于按相关性顺序查找工件。它为查询中的每个输入关联一个数值分数到最终工件。一旦您有了每个工件的相关性分数，就可以根据这些分数对工件进行排名，并预测排名最高的N个最佳匹配值。有关XGBoost和SageMaker的详细信息，请参阅博文[“介绍开源Amazon
    SageMaker XGBoost算法容器”](https://oreil.ly/NmfuI)。
- en: An MLP is a supervised deep-learning method that deals with training multilayer
    artificial neural networks, also called deep neural networks. MLP learns the relationship
    between linear and nonlinear data. It is a feed-forward artificial neural network
    that generates a set of outputs from a set of inputs. An MLP is characterized
    by several layers of input nodes connected as a directed graph between the input
    and output layers. Typical applications for MLP algorithms are for image classification,
    speech recognition, and machine translation.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: MLP 是一种监督深度学习方法，用于训练多层人工神经网络，也称为深度神经网络。MLP 学习线性和非线性数据之间的关系。它是一种前馈人工神经网络，从一组输入生成一组输出。MLP
    以几层输入节点连接的方式作为输入和输出层之间的有向图来特征化。MLP 算法的典型应用包括图像分类、语音识别和机器翻译。
- en: Linear models are supervised learning algorithms used for solving either classification
    or regression problems. You give the linear learner model labeled data and the
    algorithm learns a linear function, or, for classification problems, a linear
    threshold function. Use linear learner algorithms for use cases such as predicting
    sales of a product, determining marketing effectiveness, or to predict customers’
    willingness to purchase a product or service. You can read more about the [SageMaker
    linear learner](https://oreil.ly/vtXU7) algorithm, which explores different training
    objectives or accuracy metrics, and chooses the best solution from a validation
    set.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 线性模型是用于解决分类或回归问题的监督学习算法。你向线性学习模型提供标记数据，算法学习一个线性函数，或者对于分类问题，学习一个线性阈值函数。线性学习算法适用于预测产品销售、确定营销效果或预测客户购买产品或服务的意愿等用例。你可以阅读更多关于[SageMaker
    线性学习](https://oreil.ly/vtXU7)算法的信息，该算法探索不同的训练目标或准确度指标，并从验证集中选择最佳解决方案。
- en: For unsupervised learning, Amazon Redshift ML supports Amazon SageMaker Random
    Cut Forest (RCF) and *k*-means algorithms. These have to be built in Amazon SageMaker
    and imported to Amazon Redshift as Bring Your Own Models. We will cover BYOM in
    [“Integration with Amazon SageMaker—Bring Your Own Model (BYOM)”](#amazon_sagemaker_byom_integration).
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 对于无监督学习，Amazon Redshift ML 支持 Amazon SageMaker Random Cut Forest (RCF) 和 *k*-means
    算法。这些必须在 Amazon SageMaker 中构建，并作为 BYOM 导入到 Amazon Redshift。我们将在[“Amazon SageMaker
    集成——自带模型（BYOM）”](#amazon_sagemaker_byom_integration)中涵盖 BYOM。
- en: RCF is a clustering technique that detects anomalous data points within a dataset
    that diverges from otherwise well-structured or patterned data. With each data
    point, RCF associates an anomaly score. Low score values indicate that the data
    point is considered “normal.” High values indicate the presence of an anomaly
    in the data. The definitions of “low” and “high” depend on the application, but
    common practice suggests that scores beyond three standard deviations from the
    mean score are considered anomalous.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: RCF 是一种聚类技术，用于检测数据集中与其余结构良好或有模式的数据不符的异常数据点。对于每个数据点，RCF 关联一个异常分数。低分值表示数据点被认为是“正常”的。高值表示数据中存在异常。“低”和“高”的定义取决于应用程序，但通常做法表明，超出均值分数三个标准偏差的分数被视为异常。
- en: If you’re using *k*-means, you define the attributes that you want the algorithm
    to use to determine *similarity*. It identifies discrete groups within your data,
    such that members of a group are as similar as possible to each another, and as
    different as possible from members of other groups. The number `k` decides the
    number of groups this algorithm will generate. *k*-means is suitable for when
    you want to make groups of similar things from a randomly distributed collection
    of things.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你使用 *k*-means，你需要定义算法用来确定 *相似性* 的属性。它识别出数据中的离散群组，使得每个群组的成员尽可能相似，并尽可能不同于其他群组的成员。数字
    `k` 决定了此算法将生成的群组数。*k*-means 适用于当你想从随机分布的事物集合中生成相似事物的群组时。
- en: Integration with Amazon SageMaker Autopilot
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 与 Amazon SageMaker Autopilot 的集成
- en: '[Amazon SageMaker](https://aws.amazon.com/sagemaker) is a fully managed machine
    learning service for data scientists and developers to build, train, and directly
    deploy models into a production-ready hosted environment.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: '[Amazon SageMaker](https://aws.amazon.com/sagemaker) 是一种全面管理的机器学习服务，供数据科学家和开发人员构建、训练并直接部署模型到生产环境中。'
- en: Amazon Redshift ML leverages the [Amazon SageMaker Autopilot](https://oreil.ly/VrhVT)
    feature that trains and tunes multiple machine learning models based on your data
    and keeps the model with the highest accuracy. Amazon SageMaker Autopilot provides
    automatic data cleaning, automatic data preprocessing, automatic algorithm selection
    for linear regression, binary classification, and multiclass classification. It
    also supports automatic [hyperparameter tuning optimization (HPO)](https://oreil.ly/kkrib),
    distributed training, automatic instance, and cluster size selection.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift ML利用[Amazon SageMaker Autopilot](https://oreil.ly/VrhVT)功能，基于您的数据训练和调整多个机器学习模型，并保留准确率最高的模型。Amazon
    SageMaker Autopilot提供自动数据清理、自动数据预处理、线性回归、二分类和多分类的自动算法选择。它还支持自动[超参数调优优化（HPO）](https://oreil.ly/kkrib)、分布式训练、自动实例和集群大小选择。
- en: Amazon SageMaker Autopilot makes it easy to build models in Amazon Redshift
    without knowing much theory about machine learning itself.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon SageMaker Autopilot使得在不需要太多关于机器学习理论的情况下，轻松在Amazon Redshift中构建模型成为可能。
- en: Create Model
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 创建模型
- en: Let’s dive into some practice creating a model. Let’s pretend you want to predict
    the results of a futuristic street race between humans and machines. You have
    historical data for previous races, the city where the race took place, the weather
    during the race, the condition of the road, the distance to be covered and the
    speed at which the human and the machine is running, and the actual result—did
    the human win the race. Yes, we are rooting for the humans!
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们深入一些实践来创建一个模型。假设您想预测人类和机器之间未来街头赛车的结果。您有先前比赛的历史数据，比赛发生的城市，比赛期间的天气，道路状况，需走的距离以及人类和机器的速度，还有实际的结果—人类是否赢得了比赛。是的，我们支持人类胜利！
- en: All you need is the table to be used for training the model and an Amazon S3
    bucket to hold the training artifacts. The code in [Example 6-3](#prepare_race_schema)
    will prepare the tables for you. You have a training table to train the ML model
    and an inference table to draw ML inferences on. Later (see [Example 6-4](#create_basic_model)),
    you’ll see the create model syntax.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 你所需的仅仅是用于训练模型的表格和一个Amazon S3存储桶来保存训练产物。在[示例 6-3](#prepare_race_schema)中的代码将为您准备这些表格。您有一个训练表用于训练机器学习模型，并且有一个推断表用于进行机器学习推断。稍后（参见[示例 6-4](#create_basic_model)），您将看到创建模型的语法。
- en: Example 6-3\. Prepare race schema
  id: totrans-89
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-3\. 准备赛车模式
- en: '[PRE2]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: In [Example 6-4](#create_basic_model), Amazon SageMaker Autopilot is doing all
    the heavy lifting for you and will figure out the best ML model to predict if
    the human will win. Tell the model to use the label `human_win_y_n`, which can
    be `True` or `False`, on training data. Since the desired target `human_win_y_n`
    is binary, Autopilot will determine that this is a binary classification problem
    and will choose the most accurate algorithm.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在[示例 6-4](#create_basic_model)中，Amazon SageMaker Autopilot将为您处理所有繁重工作，并找出最佳的机器学习模型来预测人类是否会获胜。告诉模型使用标签`human_win_y_n`，其值可以是`True`或`False`，在训练数据上。由于期望的目标`human_win_y_n`是二元的，Autopilot将确定这是一个二元分类问题，并选择最准确的算法。
- en: Example 6-4\. Create model
  id: totrans-92
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-4\. 创建模型
- en: '[PRE3]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: We have set `MAX_RUNTIME` higher than default 5400 (1.5 hours) for this example
    to ensure the model explainability report in [Table 6-3](#explain_model_result)
    is generated successfully.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在这个示例中将`MAX_RUNTIME`设置得比默认的5400（1.5小时）要高，以确保在[表 6-3](#explain_model_result)中生成的模型可解释性报告成功。
- en: Use the `show model` command in [Example 6-5](#show_model) to review the ML
    model status. Inspect the `Model State` to determine if the model is ready. When
    you first create your model, you will see the a status of `TRAINING`.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 使用[示例 6-5](#show_model)中的`show model`命令查看ML模型状态。检查`模型状态`以确定模型是否准备好。当您首次创建模型时，您将看到`TRAINING`的状态。
- en: Example 6-5\. Show model
  id: totrans-96
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-5\. 显示模型
- en: '[PRE4]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Table 6-1\. Show model—`TRAINING`
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 表 6-1\. 显示模型—`TRAINING`
- en: '| Key | Value |'
  id: totrans-99
  prefs: []
  type: TYPE_TB
  zh: '| 键 | 值 |'
- en: '| --- | --- |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Model Name | human_vs_machine |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
  zh: '| 模型名称 | 人类对机器 |'
- en: '| Schema Name | race |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
  zh: '| 模式名称 | race |'
- en: '| Owner | model_create_user |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
  zh: '| 所有者 | model_create_user |'
- en: '| Creation Time | Tue, 12.12.2023 05:10:15 |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
  zh: '| 创建时间 | 星期二, 12.12.2023 05:10:15 |'
- en: '| Model State | TRAINING |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
  zh: '| 模型状态 | 训练中 |'
- en: '| …​ |  |'
  id: totrans-106
  prefs: []
  type: TYPE_TB
  zh: '| …​ |  |'
- en: When your model has a state of `READY`, the process is complete and you can
    begin using your model. You can check the `objective` and corresponding `validation`
    score to determine the model accuracy. As shown in [Table 6-2](#show_model_ready),
    the objective is `f1` and the score is 0.93432, i.e., 93.43% accuracy score. The
    estimated cost is the estimated [SageMaker processing hours](https://oreil.ly/S-aSp)
    needed to derive the model. A model with a higher accuracy score will generate
    more accurate model predictions, but that higher accuracy can come at a higher
    cost. We will cover costs in [“Amazon Redshift ML Costs”](#redshift_ml_costs).
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 当你的模型处于`READY`状态时，流程已完成，你可以开始使用你的模型。你可以检查`objective`和相应的`validation`分数来确定模型的准确性。如[表 6-2](#show_model_ready)所示，目标是`f1`，得分为0.93432，即93.43%的准确率得分。估算成本是推导模型所需的预估[SageMaker处理小时数](https://oreil.ly/S-aSp)。准确率高的模型将生成更精确的模型预测，但更高的准确率可能意味着更高的成本。我们将在[“Amazon
    Redshift ML Costs”](#redshift_ml_costs)中介绍成本。
- en: Table 6-2\. Show model—`READY`
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 表 6-2\. 展示模型—`READY`
- en: '| Key | Value |'
  id: totrans-109
  prefs: []
  type: TYPE_TB
  zh: '| 键 | 值 |'
- en: '| --- | --- |'
  id: totrans-110
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Model Name | human_vs_machine |'
  id: totrans-111
  prefs: []
  type: TYPE_TB
  zh: '| 模型名称 | human_vs_machine |'
- en: '| Schema Name | race |'
  id: totrans-112
  prefs: []
  type: TYPE_TB
  zh: '| 模式名称 | race |'
- en: '| Owner | model_create_user |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
  zh: '| 所有者 | model_create_user |'
- en: '| Creation Time | Tue, 12.12.2023 05:10:15 |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
  zh: '| 创建时间 | 2023年12月12日星期二05:10:15 |'
- en: '| Model State | READY |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
  zh: '| 模型状态 | READY |'
- en: '| Training Job Status | MaxAutoMLJobRuntimeReached |'
  id: totrans-116
  prefs: []
  type: TYPE_TB
  zh: '| 训练作业状态 | MaxAutoMLJobRuntimeReached |'
- en: '| validation:f1_binary | 0.93432 |'
  id: totrans-117
  prefs: []
  type: TYPE_TB
  zh: '| 验证:f1_binary | 0.93432 |'
- en: '| Estimated Cost | 20.805736 |'
  id: totrans-118
  prefs: []
  type: TYPE_TB
  zh: '| 预估成本 | 20.805736 |'
- en: '|  |  |'
  id: totrans-119
  prefs: []
  type: TYPE_TB
  zh: '|  |  |'
- en: '| TRAINING DATA: |  |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '| 训练数据: |  |'
- en: '| Table | race.speed_training |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| 表 | race.speed_training |'
- en: '| Target Column | HUMAN_WIN_Y_N |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| 目标列 | HUMAN_WIN_Y_N |'
- en: '|  |  |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '|  |  |'
- en: '| PARAMETERS: |  |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| 参数: |  |'
- en: '| Model Type | xgboost |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| 模型类型 | xgboost |'
- en: '| Problem Type | BinaryClassification |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| 问题类型 | 二元分类 |'
- en: '| Objective | F1 |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| 目标 | F1 |'
- en: '| AutoML Job Name | redshiftml-20230114201510598817 |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| AutoML作业名称 | redshiftml-20230114201510598817 |'
- en: '| Function Name | fnc_will_human_win |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| 函数名称 | fnc_will_human_win |'
- en: '|  | fnc_will_human_win_prob |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '|  | fnc_will_human_win_prob |'
- en: '| Function Parameters | city machine_distance human_distance |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| 函数参数 | city machine_distance human_distance |'
- en: '|  | weather road_condition machine_speed |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '|  | weather road_condition machine_speed |'
- en: '|  | human_speed |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '|  | human_speed |'
- en: '| Function Parameter Types | varchar numeric numeric |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| 函数参数类型 | varchar numeric numeric |'
- en: '|  | varchar varchar numeric |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '|  | varchar varchar numeric |'
- en: '|  | numeric |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '|  | numeric |'
- en: '| IAM Role | default-aws-iam-role |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
  zh: '| IAM角色 | default-aws-iam-role |'
- en: '| S3 Bucket | my_ml_bucket |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
  zh: '| S3存储桶 | my_ml_bucket |'
- en: '| Max Runtime | 3800 |'
  id: totrans-139
  prefs: []
  type: TYPE_TB
  zh: '| 最大运行时间 | 3800 |'
- en: An accuracy score above 80% is considered a good score, but based on your specific
    use case you can choose to tune further to go higher.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 准确率超过80%被认为是一个良好的分数，但根据您的具体用例，您可以选择进一步调整以获得更高的分数。
- en: To run inferences, simply use the function `fnc_will_human_win` in your SQL
    queries. You need to grant execute privilege on your model to identities that
    will be running inferences, as shown in [Example 6-6](#run_inference).
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行推断，只需在您的SQL查询中使用函数`fnc_will_human_win`。您需要授予执行模型的权限给将运行推断的标识，如[示例 6-6](#run_inference)所示。
- en: Example 6-6\. Run inference using model
  id: totrans-142
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-6\. 使用模型进行推断
- en: '[PRE5]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: It is good practice to have a set of *untrained* data to validate the `F1` score.
    Run an inference query and compare the ML model predicted value to the actual
    value from the *untrained* data.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 在验证`F1`分数时，拥有一组*未经训练*的数据是个好习惯。运行推断查询并将ML模型预测值与*未经训练*数据中的实际值进行比较。
- en: In the preceding example, we showed how you can use Amazon SageMaker Autopilot
    to create your model by only providing the table with training data and the target
    column in the table you are trying to predict. Amazon Redshift ML also provides
    options to create models with user guidance parameters where you can specify options
    like model type, problem type, objective, and preprocessors in the `CREATE MODEL`
    command, as shown in [Example 6-7](#full_create_model). If you know the problem
    type and/or model type and/or objective, then specifying these values in the `CREATE
    MODEL` command will reduce the model create time and the associated cost. In some
    cases, you need a custom algorithm or preprocessor. In those situations, you will
    need to specify these parameters.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在前面的示例中，我们展示了如何使用Amazon SageMaker Autopilot仅通过提供训练数据表和表中的目标列来创建您的模型。Amazon Redshift
    ML还提供了使用用户指导参数创建模型的选项，您可以在`CREATE MODEL`命令中指定模型类型、问题类型、目标和预处理器，如[示例 6-7](#full_create_model)所示。如果您知道问题类型和/或模型类型和/或目标，则在`CREATE
    MODEL`命令中指定这些值将减少模型创建时间和相关成本。在某些情况下，您需要自定义算法或预处理器。在这些情况下，您需要指定这些参数。
- en: See [the create model documentation](https://oreil.ly/KbxLq) to review details
    for all the options shown in [Example 6-7](#full_create_model).
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 查看[创建模型文档](https://oreil.ly/KbxLq)以查看[示例 6-7](#full_create_model)中显示的所有选项的详细信息。
- en: Example 6-7\. Full create model
  id: totrans-147
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-7\. 完整创建模型
- en: '[PRE6]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: The setting `S3_GARBAGE_COLLECT` is used to automatically clear the Amazon S3
    bucket used to hold the training artifacts after the model is ready. However,
    if disabled, you can use the files created in Amazon S3 a few different ways using
    the BYOM strategy (see [“Integration with Amazon SageMaker—Bring Your Own Model
    (BYOM)”](#amazon_sagemaker_byom_integration)). If you delete your Amazon Redshift
    data warehouse, you can use the files to re-create your inference function. You
    can also use the files to implement model versioning; for example, before re-training
    your model, you can create an *old* version of the model using the files. Lastly,
    you can create your model on one Amazon Redshift data warehouse, but expose the
    model on another Amazon Redshift data warehouse without going through the process
    of training it.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 设置`S3_GARBAGE_COLLECT`用于在模型准备就绪后自动清除用于保存训练工件的Amazon S3存储桶。但是，如果禁用此设置，您可以使用Amazon
    S3中创建的文件的多种方式，使用BYOM策略（参见[“与Amazon SageMaker集成—Bring Your Own Model (BYOM)”](#amazon_sagemaker_byom_integration)）。如果删除Amazon
    Redshift数据仓库，则可以使用这些文件重新创建推断函数。您还可以使用这些文件实现模型版本控制；例如，在重新训练模型之前，可以使用文件创建旧版本的模型。最后，您可以在一个Amazon
    Redshift数据仓库上创建您的模型，但是在另一个Amazon Redshift数据仓库上公开该模型，而无需经过重新训练的过程。
- en: Label Probability
  id: totrans-150
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标签概率
- en: 'A label is the value or outcome you are predicting. For the `human_vs_machine`
    model, you are predicting whether the human will win, which has two possible outcomes
    or labels: `true` for when the human wins, and `false` for when the human does
    not win. The label probability metrics assign a probability value to each label
    to indicate the likelihood of its occurrence. You can access the label probability
    metrics assigned to each label by using the `fnc_will_human_win_prob` inference
    function, which will output a percentage likelihood of its occurrence. The probability
    metrics are available when creating `AUTO ON` models with a problem type of either
    binary classification or multiclass classification.'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 标签是您要预测的值或结果。对于`human_vs_machine`模型，您要预测的是人类是否会获胜，有两种可能的结果或标签：`true`表示人类获胜，`false`表示人类未获胜。标签概率度量将概率值分配给每个标签，以指示其发生的可能性。您可以通过使用`fnc_will_human_win_prob`推断函数访问分配给每个标签的标签概率度量，该函数将输出其发生的百分比可能性。当创建问题类型为二元分类或多类分类的`AUTO
    ON`模型时，可以使用标签概率度量。
- en: The label probabilities are computed for each row, and without actually running
    the ML model. You can run this on your inference dataset to get an indication
    of expected outcome.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 标签概率是为每一行计算的，而不是实际运行ML模型。您可以在推断数据集上运行此功能，以获取预期结果的指示。
- en: The probability function `fnc_will_human_win_prob` is automatically created
    by Amazon Redshift ML using the function name `fnc_will_human_win` you provided
    for the ML model and adding the `_prob` suffix.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 概率函数`fnc_will_human_win_prob`由Amazon Redshift ML自动创建，使用您为ML模型提供的函数名`fnc_will_human_win`并添加`_prob`后缀。
- en: Example 6-8\. Label probabilities
  id: totrans-154
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-8\. 标签概率
- en: '[PRE7]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '| fnc_will_human_win_prob |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
  zh: '| fnc_will_human_win_prob |'
- en: '| --- |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
  zh: '| --- |'
- en: '| {"probabilities”:[0.98792028,0.01207972],"labels”:["f”,"t"]} |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| {"probabilities”:[0.98792028,0.01207972],"labels”:["f”,"t"]} |'
- en: '| {"probabilities”:[0.99937975,0.00062025],"labels”:["f”,"t"]} |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| {"probabilities”:[0.99937975,0.00062025],"labels”:["f”,"t"]} |'
- en: '| {"probabilities”:[0.91194165,0.08805832],"labels”:["t”,"f"]} |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| {"probabilities”:[0.91194165,0.08805832],"labels”:["t”,"f"]} |'
- en: '| {"probabilities”:[0.95782197,0.04217804],"labels”:["t”,"f"]} |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
  zh: '| {"probabilities”:[0.95782197,0.04217804],"labels”:["t”,"f"]} |'
- en: '| {"probabilities”:[0.93414819,0.06585180],"labels”:["t”,"f"]} |'
  id: totrans-162
  prefs: []
  type: TYPE_TB
  zh: '| {"probabilities”:[0.93414819,0.06585180],"labels”:["t”,"f"]} |'
- en: Here you can see that probability for a human to win the race is lower on the
    input data for the first two rows, and higher on the next three.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在这里，您可以看到在输入数据的前两行中，人类赢得比赛的概率较低，而在接下来的三行中，概率较高。
- en: Explain Model
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 解释模型
- en: In machine learning, each independent variable used as input to the model is
    called a feature. In Amazon Redshift ML, the columns that you used to build the
    model are the features for that model.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在机器学习中，每个作为模型输入的独立变量称为特征。在Amazon Redshift ML中，您用于构建模型的列是该模型的特征。
- en: The `explain_model` command ([Example 6-9](#ex_model_comm)) provides the ML
    models explainability report, which contains information about the [Shapley value](https://oreil.ly/HwYfZ)
    for all model features. These Shapley values help you understand the contribution
    that each feature made to model predictions. Shapley value is the mean marginal
    contribution of each feature value across all possible values in the feature space.
    A higher Shapley value for a feature implies this particular feature has higher
    influence on the prediction result.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '`explain_model` 命令 ([示例 6-9](#ex_model_comm)) 提供了 ML 模型的可解释性报告，其中包含有关所有模型特征的
    [Shapley 值](https://oreil.ly/HwYfZ) 的信息。这些 Shapley 值帮助您理解每个特征对模型预测的贡献。Shapley
    值是在特征空间中所有可能值的平均边际贡献。较高的 Shapley 值意味着该特征对预测结果有更大的影响。'
- en: Example 6-9\. Explain model command
  id: totrans-167
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-9\. 解释模型命令
- en: '[PRE8]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You see in [Table 6-3](#explain_model_result) that `city` and `human_speed`
    influence much less compared to `road_condition` with `1.04` and `weather` with
    `1.46`. You may be able to infer from this data that either humans or machines
    are better at adapting to weather and road conditions.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 您在 [表 6-3](#explain_model_result) 中看到，`city` 和 `human_speed` 对比 `road_condition`
    的 `1.04` 和 `weather` 的 `1.46` 影响要小得多。您可以从这些数据中推断出，无论是人类还是机器在适应天气和道路条件方面，可能更好。
- en: Table 6-3\. Explain model results
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 表 6-3\. 解释模型结果
- en: '| explain_model |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| explain_model |'
- en: '| --- |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| --- |'
- en: '| {"explanations”:{"kernel_shap”:{"label0”:{ “expected_value”:-0.5694439538988466,
    “global_shap_values”:{ “city”:0.2865426473431818, “human_distance”:0.8485933955733828,
    “human_speed”:0.4954490773124456, “machine_distance”:0.8925393014624781, “machine_speed”:0.7125560417928333,
    “road_condition”:1.0487996886952989, “weather”:1.460974788708901} }}},"version”:"1.0"}
    |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| {"explanations”:{"kernel_shap”:{"label0”:{ “expected_value”:-0.5694439538988466,
    “global_shap_values”:{ “city”:0.2865426473431818, “human_distance”:0.8485933955733828,
    “human_speed”:0.4954490773124456, “machine_distance”:0.8925393014624781, “machine_speed”:0.7125560417928333,
    “road_condition”:1.0487996886952989, “weather”:1.460974788708901} }}},"version”:"1.0"}'
- en: The `explain_model` command leverages Amazon SageMaker Clarify, which provides
    tools to help explain how ML models make predictions. See [Amazon SageMaker Clarify
    Model Explainability](https://oreil.ly/-V9BF) for additional details.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '`explain_model` 命令利用亚马逊 SageMaker Clarify，提供工具来帮助解释 ML 模型如何进行预测。有关详细信息，请参见
    [Amazon SageMaker Clarify 模型可解释性](https://oreil.ly/-V9BF)。'
- en: The model explainability report is automatically generated after the ML model
    has been trained. You might see an error returned for `explain_model` if the model
    training was interrupted due to a `MAX_RUNTIME` parameter. In such cases you can
    increase the `MAX_RUNTIME` value and rerun the training.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在 ML 模型训练后，模型可解释性报告将自动生成。如果由于 `MAX_RUNTIME` 参数中断了模型训练，您可能会看到对 `explain_model`
    的错误返回。在这种情况下，您可以增加 `MAX_RUNTIME` 值并重新运行训练。
- en: Using Amazon Redshift ML to Predict Student Outcomes
  id: totrans-176
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用亚马逊 Redshift ML 预测学生的结果
- en: 'In [Chapter 3](ch03.html#AR_TGD_CH3), we discussed [“Student Information Learning
    Analytics Dataset”](ch03.html#sis_dataset). Let’s use what we learned about Amazon
    Redshift ML and use the student learning dataset to build a model that predicts
    a student’s performance result: pass, fail, withdraw, or distinction. You will
    also determine the most important factors influencing the student’s performance.'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 在 [第 3 章](ch03.html#AR_TGD_CH3) 中，我们讨论了 [“学生信息学习分析数据集”](ch03.html#sis_dataset)。让我们利用我们对亚马逊
    Redshift ML 的了解，并使用学生学习数据集构建一个模型，预测学生的表现结果：通过、失败、退出或优异。您还将确定影响学生表现最重要的因素。
- en: You will first create the training dataset as a table from the historical data.
    This table will contain student demographic information, the data gathered from
    learning management system (LMS), and scores from student assessments. You will
    use these inputs as features for building your ML model to predict a student’s
    performance result, the `final_result` column.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，您将从历史数据创建训练数据集作为表格。此表将包含学生人口统计信息、从学习管理系统（LMS）收集的数据以及学生评估成绩。您将使用这些输入作为构建 ML
    模型的特征，以预测学生的表现结果，即 `final_result` 列。
- en: Table `tbl_student_lmsactivities_and_score` in [Example 6-10](#sis_model_features)
    is created by joining the `student_info`, the aggregate of clicks from `student_lms`,
    and the aggregate of scores from `student_assessment`. This is an important aspect
    of *feature engineering*, i.e., the pivoting of data so that all inputs can go
    into the training/inference process.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 表格 `tbl_student_lmsactivities_and_score` 在 [示例 6-10](#sis_model_features) 中通过连接
    `student_info`、`student_lms` 中的点击总数以及 `student_assessment` 中的分数总数而创建。这是*特征工程*的一个重要方面，即数据透视，使所有输入能够进入训练/推断过程。
- en: Example 6-10\. Openlearn ML model features
  id: totrans-180
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-10\. Openlearn 机器学习模型特征
- en: '[PRE9]'
  id: totrans-181
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Now, run the `CREATE MODEL` command on the `tbl_student_lmsactivities_and_score`
    table to invoke Amazon SageMaker Autopilot.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，在 `tbl_student_lmsactivities_and_score` 表上运行 `CREATE MODEL` 命令以调用 Amazon
    SageMaker Autopilot。
- en: Example 6-11\. Openlearn create model
  id: totrans-183
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-11\. Openlearn 创建模型
- en: '[PRE10]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Similar to the previous example, we have set `MAX_RUNTIME` higher than default
    5400 (1.5 hours) for this example to ensure the model explainability report in
    [Table 6-3](#explain_model_result) is generated successfully.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 与前面的示例类似，我们将 `MAX_RUNTIME` 设置得比默认的 5400（1.5 小时）更高，以确保在 [表 6-3](#explain_model_result)
    中生成模型可解释性报告成功。
- en: Now, you can execute the `show model` command to see details of the model Amazon
    SageMaker Autopilot chose. You will see in [Table 6-4](#show_model_sis) that it
    was able to choose a model with 87% accuracy, and since you are determining one
    of several possible labels (`Withdrawn`, `Pass`, `Distinction`, and `Fail`), it
    has determined that the problem type is a multiclass classification.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，您可以执行 `show model` 命令查看 Amazon SageMaker Autopilot 选择的模型的详细信息。您将在 [表 6-4](#show_model_sis)
    中看到，它能够选择一个准确率为 87% 的模型，并且由于您确定了多个可能的标签之一（`退课`、`通过`、`优异` 和 `不及格`），它确定问题类型是多类分类。
- en: Example 6-12\. Show model
  id: totrans-187
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-12\. 展示模型
- en: '[PRE11]'
  id: totrans-188
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Table 6-4\. Show model output
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 表 6-4\. 展示模型输出
- en: '| Key | Value |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| 键 | 值 |'
- en: '| --- | --- |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| Model Name | student_result |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| 模型名称 | student_result |'
- en: '| Schema Name | public |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| 模式名称 | public |'
- en: '| Owner | model_create_user |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| 所有者 | model_create_user |'
- en: '| Creation Time | Sun, 05.03.2024 18:54:11 |'
  id: totrans-195
  prefs: []
  type: TYPE_TB
  zh: '| 创建时间 | 日，2024年03月05日 18:54:11 |'
- en: '| Model State | READY |'
  id: totrans-196
  prefs: []
  type: TYPE_TB
  zh: '| 模型状态 | READY |'
- en: '| validation:accuracy | 0.870610 |'
  id: totrans-197
  prefs: []
  type: TYPE_TB
  zh: '| 验证精度 | 0.870610 |'
- en: '| Estimated Cost | 29.814964 |'
  id: totrans-198
  prefs: []
  type: TYPE_TB
  zh: '| 预计成本 | 29.814964 |'
- en: '|  |  |'
  id: totrans-199
  prefs: []
  type: TYPE_TB
  zh: '|  |  |'
- en: '| TRAINING DATA: |  |'
  id: totrans-200
  prefs: []
  type: TYPE_TB
  zh: '| 训练数据： |  |'
- en: '| Table | tbl_student_lmsactivities_and_score |'
  id: totrans-201
  prefs: []
  type: TYPE_TB
  zh: '| 表 | tbl_student_lmsactivities_and_score |'
- en: '| Target Column | FINAL_RESULT |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '| 目标列 | FINAL_RESULT |'
- en: '|  |  |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '|  |  |'
- en: '| PARAMETERS: |  |'
  id: totrans-204
  prefs: []
  type: TYPE_TB
  zh: '| 参数： |  |'
- en: '| Model Type | xgboost |'
  id: totrans-205
  prefs: []
  type: TYPE_TB
  zh: '| 模型类型 | xgboost |'
- en: '| Problem Type | MulticlassClassification |'
  id: totrans-206
  prefs: []
  type: TYPE_TB
  zh: '| 问题类型 | 多类分类 |'
- en: '| Objective | Accuracy |'
  id: totrans-207
  prefs: []
  type: TYPE_TB
  zh: '| 目标 | 准确性 |'
- en: '| AutoML Job Name | redshiftml-20230305185411524819 |'
  id: totrans-208
  prefs: []
  type: TYPE_TB
  zh: '| AutoML 任务名称 | redshiftml-20230305185411524819 |'
- en: '| Function Name | fnc_final_result |'
  id: totrans-209
  prefs: []
  type: TYPE_TB
  zh: '| 函数名称 | fnc_final_result |'
- en: '|  | fnc_final_result_prob |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
  zh: '|  | fnc_final_result_prob |'
- en: '| Function Parameters | id_student code_module code_presentation |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
  zh: '| 函数参数 | id_student code_module code_presentation |'
- en: '|  | gender region highest_education imd_band |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
  zh: '|  | 性别 地区 最高教育程度 imd_band |'
- en: '|  | age_band num_of_prev_atteempts |'
  id: totrans-213
  prefs: []
  type: TYPE_TB
  zh: '|  | 年龄段 前几次尝试次数 |'
- en: '|  | studied_credits disability sum_of_clicks |'
  id: totrans-214
  prefs: []
  type: TYPE_TB
  zh: '|  | 学习学分 残疾 点击总数 |'
- en: '|  | total_score mean_score |'
  id: totrans-215
  prefs: []
  type: TYPE_TB
  zh: '|  | 总分 平均分 |'
- en: '| Function Parameter Types | int4 varchar varchar |'
  id: totrans-216
  prefs: []
  type: TYPE_TB
  zh: '| 函数参数类型 | int4 varchar varchar |'
- en: '|  | bpchar varchar varchar varchar |'
  id: totrans-217
  prefs: []
  type: TYPE_TB
  zh: '|  | bpchar varchar varchar varchar |'
- en: '|  | varchar int2 |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '|  | varchar int2 |'
- en: '|  | int2 bpchar int8 |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '|  | int2 bpchar int8 |'
- en: '|  | int8 int8 |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '|  | int8 int8 |'
- en: '| IAM Role | default-aws-iam-role |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| IAM 角色 | default-aws-iam-role |'
- en: '| S3 Bucket | my_ml_bucket |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| S3 存储桶 | my_ml_bucket |'
- en: '| Max Runtime | 10800 |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
  zh: '| 最大运行时间 | 10800 |'
- en: Lastly, you can execute the `explain_model` command to see the Shapley values.
    You see in [Example 6-13](#explain_model_sis) that `gender`, `region`, `previous
    attempts`, and `disability` influence much less compared to `age band` with `0.51`,
    `highest education` with `0.59`, and `studied credits` with `0.66`. `Number of
    clicks` with a value of `0.99` seems to be the most important factor in determining
    student performance. `Number of clicks` represents interactions with virtual learning
    environments. Based on this ML model, you can expect that increasing engagement
    with virtual learning environments should lead to improvement in students results—for
    example, adding a pop quiz between virtual course content.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，您可以执行`explain_model`命令以查看Shapley值。您可以在[示例 6-13](#explain_model_sis)中看到，与`年龄段`相比，`性别`、`地区`、`以前的尝试`和`残疾`的影响较小，分别为`0.51`、`最高学历`为`0.59`、`学习学分`为`0.66`。具有`0.99`值的`点击次数`似乎是决定学生表现最重要的因素。`点击次数`表示与虚拟学习环境的互动。基于此ML模型，您可以预期增加与虚拟学习环境的互动应该会改善学生的成绩—例如，在虚拟课程内容之间增加一场小测验。
- en: Example 6-13\. Explain model student_result
  id: totrans-225
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-13\. 解释模型`student_result`
- en: '[PRE12]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '| global_shap_values |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
  zh: '| global_shap_values |'
- en: '| --- |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
  zh: '| --- |'
- en: '| “age_band”:0.510843481387332466, “code_module”:0.1775745286500845, “code_presentation”:0.09353407379714834,
    “disability”:0.051944180058839748, “gender”:0.05065581722765354, “highest_education”:0.592895528627924518,
    “id_student”:0.00000483678127755, “imd_band”:0.033637420953443259, “mean_score”:0.2120711173613374,
    “num_of_prev_attempts”:0.05241636943859941, “region”:0.13375708054846678, “studied_credits”:0.6551317963150247,
    “sum_of_clicks”:0.9983975396249064, “total_score”:0.25218934352064467 |'
  id: totrans-229
  prefs: []
  type: TYPE_TB
  zh: '| “年龄段”:0.510843481387332466, “code_module”:0.1775745286500845, “code_presentation”:0.09353407379714834,
    “残疾”:0.051944180058839748, “性别”:0.05065581722765354, “最高学历”:0.592895528627924518,
    “id_student”:0.00000483678127755, “imd_band”:0.033637420953443259, “mean_score”:0.2120711173613374,
    “num_of_prev_attempts”:0.05241636943859941, “地区”:0.13375708054846678, “studied_credits”:0.6551317963150247,
    “sum_of_clicks”:0.9983975396249064, “total_score”:0.25218934352064467 |'
- en: Amazon SageMaker Integration with Amazon Redshift
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Amazon SageMaker与Amazon Redshift集成
- en: So far, we’ve described how users can create models and run inferences using
    SQL. For data scientist users who build and train models in Amazon SageMaker,
    the Amazon SageMaker Studio is an IDE that provides a single web-based visual
    interface where you can access tools to perform all machine learning. SageMaker
    notebooks is a popular interface running the Jupyter Notebook app to prepare and
    process data, write code to train models, deploy models to SageMaker hosting,
    and test or validate your models. The Amazon Redshift Data API discussed in [“Amazon
    Redshift Data API”](ch02.html#redshift_data_api) simplifies the connectivity management,
    and Jupyter Notebook is preloaded with libraries needed to access Amazon Redshift
    Data API. This makes it easy to use data from Amazon Redshift for advanced ML
    training in Amazon SageMaker.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经描述了用户如何使用SQL创建模型并进行推断。对于在Amazon SageMaker中构建和训练模型的数据科学家用户，Amazon SageMaker
    Studio是一个提供单一基于Web的视觉界面的IDE，您可以访问工具以执行所有机器学习操作。SageMaker笔记本是一个流行的界面，运行Jupyter
    Notebook应用程序以准备和处理数据，编写代码来训练模型，将模型部署到SageMaker托管环境，并测试或验证您的模型。在[“Amazon Redshift数据API”](ch02.html#redshift_data_api)讨论的Amazon
    Redshift数据API简化了连接管理，而Jupyter Notebook预加载了访问Amazon Redshift数据API所需的库。这使得在Amazon
    SageMaker中使用来自Amazon Redshift的数据进行高级ML训练变得简单。
- en: Amazon SageMaker Canvas allows business analysts to build ML models without
    writing code or requiring ML expertise. Once you [grant users permissions for
    Amazon Redshift](https://oreil.ly/WSKwt), then you can import Amazon Redshift
    data by using SQL queries and joins that are pushed down to Amazon Redshift to
    leverage native features.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon SageMaker Canvas允许业务分析师在不编写代码或需要ML专业知识的情况下构建ML模型。一旦您[授予用户访问Amazon Redshift的权限](https://oreil.ly/WSKwt)，您可以通过使用SQL查询和连接，将Amazon
    Redshift数据导入，并将其推送到Amazon Redshift以利用其本地特性。
- en: Integration with Amazon SageMaker—Bring Your Own Model (BYOM)
  id: totrans-233
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Amazon SageMaker集成—自定义模型（BYOM）
- en: For advanced ML models created outside of Amazon Redshift, if it meets the requirements
    for Redshift ML, you can bring it into Amazon Redshift for running ML inferences.
    You can import these pretrained models and use them for either local inferences
    or remote inferences. The models could have been created and trained using Amazon
    Redshift data, as described in [“Amazon SageMaker Integration with Amazon Redshift”](#sagemaker_integration_redshift),
    or they could have been created and trained with other data sources.
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
  zh: 对于在 Amazon Redshift 外部创建的高级 ML 模型，如果满足 Redshift ML 的要求，可以将其引入 Amazon Redshift
    以进行 ML 推理。您可以导入这些预训练模型，用于本地推理或远程推理。这些模型可以使用 Amazon Redshift 数据创建和训练，详见[“Amazon
    SageMaker 与 Amazon Redshift 集成”](#sagemaker_integration_redshift)，或者可以使用其他数据源创建和训练。
- en: 'To bring your own SageMaker model to Amazon Redshift, the following criteria
    must be met:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: 要将自己的 SageMaker 模型引入 Amazon Redshift，必须满足以下条件：
- en: The model must accept inputs in the format of CSV through a content type of
    text or CSV in SageMaker.
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型必须通过文本或 CSV 的内容类型接受 CSV 格式的输入。
- en: The endpoint must be hosted by the same AWS account that owns the Amazon Redshift
    data warehouse.
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端点必须由拥有 Amazon Redshift 数据仓库的同一 AWS 账户托管。
- en: The outputs of models must be a single value of the type specified on creating
    the function.
  id: totrans-238
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型的输出必须是在创建函数时指定类型的单个值。
- en: The models must accept nulls as empty strings.
  id: totrans-239
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模型必须接受空值作为空字符串处理。
- en: The Amazon SageMaker endpoint must have enough resources to accommodate inference
    calls from Amazon Redshift or the SageMaker endpoint can be [automatically scaled](https://oreil.ly/gvDJk).
  id: totrans-240
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon SageMaker 端点必须具有足够资源来容纳来自 Amazon Redshift 的推理调用，或者 SageMaker 端点可以进行[自动扩展](https://oreil.ly/gvDJk)。
- en: BYOM Local
  id: totrans-241
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: BYOM 本地
- en: '[Example 6-14](#byom_local) is query syntax for BYOM local inferences. You
    can specify either a SageMaker job name or the Amazon S3 location of the `.tar.gz`
    model artifact file that was generated by a SageMaker job. The ML model gets stored
    as a locally compiled Amazon Redshift function.'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: '[示例 6-14](#byom_local) 是 BYOM 本地推理的查询语法。您可以指定一个 SageMaker 作业名称或者由 SageMaker
    作业生成的 `.tar.gz` 模型工件文件在 Amazon S3 上的位置。ML 模型被存储为本地编译的 Amazon Redshift 函数。'
- en: Example 6-14\. BYOM local
  id: totrans-243
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-14\. BYOM 本地
- en: '[PRE13]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: When running inferences on a local BYOM ML model, the Amazon Redshift SQL function
    is invoked locally within Amazon Redshift and predictions are drawn, thus there
    is no SageMaker involved.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 在本地运行 BYOM ML 模型推理时，Amazon Redshift SQL 函数会在 Amazon Redshift 中本地调用，并进行预测，因此不涉及
    SageMaker。
- en: BYOM Remote
  id: totrans-246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: BYOM 远程
- en: You can also draw remote inferences in Amazon Redshift referencing the SageMaker
    model endpoint. [Example 6-15](#byom_remote) is query syntax for BYOM remote inferences.
    The `sagemaker` keyword tells Amazon Redshift ML that this particular ML model
    is a SageMaker model for remote inferences.
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 您也可以在 Amazon Redshift 中引用 SageMaker 模型端点进行远程推理。[示例 6-15](#byom_remote) 是 BYOM
    远程推理的查询语法。`sagemaker` 关键字告诉 Amazon Redshift ML 此特定 ML 模型是用于远程推理的 SageMaker 模型。
- en: When running inference queries in Amazon Redshift on a remote BYOM model, the
    SageMaker ML model is invoked and predictions are drawn directly from SageMaker.
  id: totrans-248
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Amazon Redshift 上运行远程 BYOM 模型推理查询时，会调用 SageMaker ML 模型，并直接从 SageMaker 获取预测。
- en: Example 6-15\. BYOM remote
  id: totrans-249
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 示例 6-15\. BYOM 远程
- en: '[PRE14]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: To see additional use cases for creating models, see [create model use cases](https://oreil.ly/aYm_k).
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 若要查看更多创建模型的用例，请参阅[创建模型用例](https://oreil.ly/aYm_k)。
- en: Amazon Redshift ML Costs
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 成本
- en: Amazon Redshift ML uses Amazon SageMaker for training your model, so there always
    is a cost associated with training your ML model. There are no additional charges
    for enabling the Amazon Redshift ML features. Also, there are no Amazon SageMaker
    costs for predictions that happen locally in Amazon Redshift, but remote predictions
    do incur Amazon SageMaker costs additionally.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon Redshift ML 使用 Amazon SageMaker 训练您的模型，因此训练 ML 模型会产生相关费用。启用 Amazon Redshift
    ML 功能不会产生额外费用。此外，在 Amazon Redshift 中进行本地预测不会产生 Amazon SageMaker 的费用，但远程预测则会额外产生
    Amazon SageMaker 费用。
- en: 'The `create model` statement provides you with `MAX_RUNTIME` and `MAX_CELLS`
    options to control the costs, time, and potential model accuracy when training
    an ML model in Amazon Redshift:'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: '`create model` 语句提供 `MAX_RUNTIME` 和 `MAX_CELLS` 选项，用于控制在 Amazon Redshift 中训练
    ML 模型时的成本、时间和潜在模型精度：'
- en: '`MAX_RUNTIME`'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: '`MAX_RUNTIME`'
- en: The default value is `5400` seconds or `90` minutes. This is the maximum amount
    of time for Amazon SageMaker training. Lowering this value limits the amount of
    time and computation spend in Amazon SageMaker, and thus reduces cost for training
    the model.
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 默认值为`5,400`秒或`90`分钟。这是亚马逊SageMaker训练的最长时间。降低此值限制了在亚马逊SageMaker中的时间和计算开销，从而减少了训练模型的成本。
- en: '`MAX_CELLS`'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
  zh: '`MAX_CELLS`'
- en: The default value is `1,000,000` cells, where a cell is a single data point
    in your dataset. So if your training data table has `12 columns` and `20,000 rows`,
    then it has `240,000 cells` for training the ML model. Using lower value for max
    cells results in Amazon Redshift ML selecting a reduced dataset for training,
    and this reduces cost and time to train the model.
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
  zh: 默认值为`1,000,000`个单元格，其中一个单元格是您数据集中的单个数据点。因此，如果您的训练数据表具有`12列`和`20,000行`，那么它有`240,000`个单元格用于训练ML模型。使用较低的最大单元格值会导致亚马逊Redshift
    ML选择减少的数据集进行训练，从而减少成本和训练模型的时间。
- en: After the training is completed, Amazon Redshift takes some time to compile
    and install the models locally, so you might see that your `create model` statement
    execution is taking longer than the `max_runtime` you specified.
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 训练完成后，亚马逊Redshift需要一些时间在本地编译和安装模型，因此您可能会发现您的`create model`语句执行时间比您指定的`max_runtime`更长。
- en: If the actual cells in the training dataset are more than the `MAX_CELLS` value,
    then Amazon Redshift will randomly choose fewer records from the training dataset.
    This randomization helps to prevent bias in the reduced training dataset while
    still providing good ML predictions.
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
  zh: 如果训练数据集中的实际单元格数超过`MAX_CELLS`值，则亚马逊Redshift将从训练数据集中随机选择较少的记录。这种随机化有助于在减少的训练数据集中防止偏差，同时仍然提供良好的机器学习预测。
- en: Setting too low values for `MAX_CELLS` and `MAX_RUNTIME` can lead to Amazon
    Redshift ML being unable to determine a ML model for you or even ending up selecting
    a model with reduced accuracy.
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
  zh: 设置`MAX_CELLS`和`MAX_RUNTIME`的值过低可能导致亚马逊Redshift ML无法为您确定机器学习模型，甚至可能选择准确度降低的模型。
- en: The majority of ML use cases fall under the one million cells default, which
    keeps the training cost under `$20` for most use cases. However, if your training
    data is more than one million cells, then pricing increases as demonstrated in
    the following example.
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数机器学习用例都属于默认的一百万个单元格范围内，这可以使大多数用例的训练成本保持在不到`$20`。然而，如果您的训练数据超过一百万个单元格，那么价格将如下例所示增加。
- en: The first 10 million cells are priced at `$20` per million cells. The next 90
    million cells are priced at `$15` per million cells. Over 100 million cells are
    priced at `$7` per million cells.
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
  zh: 前1千万个单元格的价格为每百万单元格`$20`。接下来的9千万个单元格的价格为每百万单元格`$15`。超过1亿单元格的价格为每百万单元格`$7`。
- en: 'Here’s a pricing example for 125 million cells:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是一个包含1.25亿单元格的定价示例：
- en: '[PRE15]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Additionally, there are Amazon S3 charges incurred based upon Amazon S3 usage
    to store the training data and model-related artifacts while the training is ongoing.
    The default garbage collection mode is to automatically remove this temporary
    Amazon S3 data once the model has been created, thus the Amazon S3 costs are minimized.
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，根据使用情况收取亚马逊S3存储训练数据和与模型相关的工件的费用。在训练期间，默认的垃圾收集模式会自动删除这些临时的亚马逊S3数据，一旦模型创建完成，亚马逊S3的费用也因此得到了最小化。
- en: Summary
  id: totrans-267
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: This chapter covered some of the machine learning use cases you can solve with
    Amazon Redshift ML. We discussed how classification and regression problems can
    be solved with supervised learning techniques that can be initiated directly in
    Amazon Redshift using the `CREATE MODEL` command. We also detailed how clustering,
    association, and dimensionality problems can be solved with unsupervised learning
    techniques in Amazon SageMaker, how you can import the data needed to train those
    models from Amazon Redshift through built-in connectors, and how those models
    can then be used back in Amazon Redshift for inference through the Bring Your
    Own Model strategy.
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涵盖了一些您可以使用亚马逊Redshift ML解决的机器学习用例。我们讨论了如何使用监督学习技术在亚马逊Redshift中直接启动`CREATE
    MODEL`命令来解决分类和回归问题。我们还详细介绍了如何使用无监督学习技术在亚马逊SageMaker中解决聚类、关联和维度问题，以及如何通过内置连接器从亚马逊Redshift导入训练这些模型所需的数据，并且如何将这些模型通过自带模型策略返回到亚马逊Redshift中用于推理。
- en: Throughout this book we’ve talked about data sharing and how it enables a modern
    data strategy because of the ability to isolate and scale workloads independently
    while enabling users with a unified data platform. In the next chapter, we’ll
    describe different use cases for data sharing and how to set up data-shares whether
    they are in the same account and region or not as well as how you can use Amazon
    DataZone to manage data-share access.
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
  zh: 在本书中，我们已经讨论了数据共享及其如何通过能够独立隔离和扩展工作负载的能力，从而支持现代数据战略。在下一章中，我们将描述数据共享的不同用例，以及如何设置数据共享，无论它们是在相同的账户和地区，还是在不同的地区，以及如何使用Amazon
    DataZone来管理数据共享访问。
